sudo: required
dist: trusty
language: java
jdk:
    - oraclejdk8
    - oraclejdk11
    
env:
    - RUNTIME=ol BUILD_TOOL=maven
#    - RUNTIME=wlp BUILD_TOOL=maven
    - RUNTIME=tomee BUILD_TOOL=maven
# - RUNTIME=ol RUNTIME_VERSION=19.0.0.2 BUILD_TOOL=gradle
# - RUNTIME=wlp RUNTIME_VERSION=19.0.0.2 BUILD_TOOL=gradle
# - RUNTIME=ol RUNTIME_VERSION=19.0.0.3 BUILD_TOOL=gradle
# - RUNTIME=wlp RUNTIME_VERSION=19.0.0.3 BUILD_TOOL=gradle
cache:
    directories:
        - $HOME/.m2
services:
    - docker
before_install:
     - docker run -d -p 5000:5000 --restart=always --name registry registry:2
install: true
before_script:
    - sudo /etc/init.d/mysql stop
script:
    - mvn install -Dinvoker.streamLogs=true
    - |
      if [ "$BUILD_TOOL" = "maven" ]; then
          export CD_COMMAND="ls";
          export TEST_COMMAND="mvn install -Pit -DboostRuntime=$RUNTIME";
      else
          export CD_COMMAND="ls";
          export TEST_COMMAND="./gradle-test.sh"
      fi;
    - ./travis.sh
